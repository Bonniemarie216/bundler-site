<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'>
<meta content='IE=edge' http-equiv='X-UA-Compatible'>
<meta content='en' http-equiv='Content-Language'>
<meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>
<meta content='276VSYOko8B8vIu1i8i5qbj7_ql5PXo0dU69XQy-SL' name='globalsign-domain-verification'>
<title>
Bundler: The best way to manage a Ruby application's gems
</title>

<script src="/application.min.js"></script>
<link href="/application.css" rel="stylesheet" />
<link href='/images/apple-touch-icon.png' rel='apple-touch-icon' sizes='180x180'>
<link href='/images/favicon-32x32.png' rel='icon' sizes='32x32' type='image/png'>
<link href='/images/favicon-16x16.png' rel='icon' sizes='16x16' type='image/png'>
<link href='/manifest.json' rel='manifest'>
<link color='#50bced' href='/images/safari-pinned-tab.svg' rel='mask-icon'>
<meta content='bundler.io' name='apple-mobile-web-app-title'>
<meta content='bundler.io' name='application-name'>
<meta content='#ffffff' name='theme-color'>

<link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/blog/feed.xml" />

</head>
<body class=''>
<link crossorigin='anonymous' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css' integrity='sha512-1ycn6IcaQQ40/MKBW2W4Rhis/DbILU74C1vSrLJxCq57o941Ym01SwNsOMqvEBFlcgUa6xLiPY/NS5R+E6ztJQ==' referrerpolicy='no-referrer' rel='stylesheet'>
<nav class='navbar navbar-expand-md navbar-light'>
<div class='container-md'>
<a href="/" class="navbar-brand me-auto fw-bold">Bundler</a>
<button aria-controls='bs-navbar-collapse' aria-expanded='false' aria-label='Toggle navigation' class='navbar-toggler' data-bs-target='#bs-navbar-collapse' data-bs-toggle='collapse' type='button'>
<span class='navbar-toggler-icon'></span>
</button>
<div class='collapse navbar-collapse flex-grow-0' id='bs-navbar-collapse'>
<ul class='navbar-nav'>
<li class='nav-item'>
<input class='input-search my-1 ps-1 pt-1' id='input-search' placeholder='Type to search...' type='text'>
<i class='fa fa-search text-opacity-40 px-1 py-2'></i>
</li>
<li class='nav-item'><a href="/docs.html" class="nav-link">Docs</a></li>
<li class='nav-item'><a href="/contributors.html" class="nav-link">Team</a></li>
<li class='nav-item'><a href="/blog" class="nav-link">Blog</a></li>
<li class='nav-item'><a href="https://github.com/rubygems/rubygems/tree/master/bundler" target="_blank" rel="noopener noreferrer" class="nav-link">Repository</a></li>
</ul>
</div>
</div>
</nav>

<div class='bg-light-blue header'>
<img src="/images/blog_header_transparent_bg.png" srcset="/images/blog_header_transparent_bg.png 1x, /images/blog_header_transparent_bg@2x.png 2x, /images/blog_header_transparent_bg@3x.png 3x" class="img-fluid header-padding" style="max-width: 350px; padding-top: 5px; width: 64%;" alt="" />
</div>

<div class='container'>
<div class='row my-5'>
<div class='col-md-12 col-xl-10 offset-xl-1'>
<div class='contents blog'>
<h2 class='title'>
<a href="/blog/2022/01/23/bundler-v2-3.html">Bundler v2.3: Locking the version of Bundler itself</a>
</h2>
<div class='subtitle'>
by
<a href="https://github.com/deivid-rodriguez/" target="_blank">David Rodríguez</a>
on
<time>
Jan 23 2022
</time>
</div>
<div class='blog-content'>
<p>2021 saw a fair amount of development in the RubyGems &amp; Bundler repositories. We
tried to release more often than ever to catch and fix bugs and distribute our
improvements as early as possible to our users. That has led to 33 patch-level versions
in the Bundler 2.x series released about a year ago.</p>

<p>Our goal for Bundler 2.3 was to implement a long-wanted feature of being able to
fully control the version of Bundler itself an application runs. There’s a long
story with this feature, because it was shipped a few years ago in a manner that
was too strict and ended up causing more harm than good, so had to be partially
reverted.</p>

<h2 id="so-how-did-things-work-before-bundler-23">So, how did things work before Bundler 2.3?</h2>

<p>Up until now, RubyGems would try to activate the version of Bundler recorded in
the <code>Gemfile.lock</code> file if already installed, and would fall back to the
highest version installed otherwise. That’s better than nothing, but it did not
ensure the exact version in the lockfile was always used, which led to
workarounds like <a href="https://bundler.io/blog/2019/05/14/solutions-for-cant-find-gem-bundler-with-executable-bundle.html">manually parsing the lockfile and then installing that
version</a>.</p>

<h2 id="and-how-do-they-work-now">And how do they work now?</h2>

<p>In Bundler 2.3 and up (if you also have RubyGems 3.3 or higher), running
<code>bundle install</code> will use the exact version from the BUNDLED WITH section of
the lockfile.  If that version is not installed before you run <code>bundle&#x000A;install</code>, the running version of Bundler will install the locked version, and
then run your original command using the newly-installed locked version.</p>

<p>So, if you have a lockfile ending with</p>

<div class="highlight"><pre class="highlight plaintext"><code>BUNDLED WITH&#x000A;   2.2.33&#x000A;</code></pre></div>
<p>and you only have Bundler 2.3.5 installed, you’ll see the following output when
running <code>bundle install</code>.</p>

<div class="highlight"><pre class="highlight plaintext"><code>$ bundle install&#x000A;Bundler 2.3.5 is running, but your lockfile was generated with 2.2.33. Installing Bundler 2.2.33 and restarting using that version.&#x000A;Fetching gem metadata from https://rubygems.org/.&#x000A;Fetching bundler 2.2.33&#x000A;Installing bundler 2.2.33&#x000A;...&#x000A;</code></pre></div>
<p>After that all your commands will automatically use Bundler 2.2.33, as specified
by your lockfile. If you want to upgrade the Bundler version used by your
application, you can run <code>bundle update --bundler</code>, and your lockfile will be
regenerated using the latest version. From that moment, all users of the
lockfile will automatically pick up the new version, no matter whether they have
a newer or older version installed instead.</p>

<p>But..</p>

<h2 id="why-are-we-doing-this">Why are we doing this?</h2>

<p>Being able to lock the version of Bundler itself, just like Bundler is able to
lock other dependencies, has been a goal of the Bundler team for years. There are
a number of benefits of locking your dependencies, like avoiding dependency
nightmares where your application breaks due to third party releases, or
avoiding “works on my machine” issues. Bundler has a ton of features and edge
cases, and</p>

<ul>
  <li>
    <p>We sometimes introduce regressions when trying to improve things. Locking the
version of Bundler prevents those issues from hitting you.</p>
  </li>
  <li>
    <p>Once in a while we need to put a security fix out there. Being able to lock
the Bundler version allows you to ensure that every user of your application
gets a secure version of Bundler.</p>
  </li>
  <li>
    <p>Occasionally, you might want to use a new feature of the Bundler DSL in your
Gemfile. However, old versions of Bundler don’t understand this feature and
you don’t want to suddenly break things for the users of yours that use those
old versions. With version locking this is no longer a concern. Bundler is now
able to upgrade itself to the version that your application understands.</p>
  </li>
</ul>

<p>All in all, we aim to provide a less surprising, less error prone and more
consistent experience when using Bundler, and let each application be in control
of the version that they use, and the moment that they upgrade.</p>

<h1 id="whats-coming-next">What’s coming next?</h1>

<p>Future enhancements to this feature might include:</p>

<ul>
  <li>Full support for <code>gem "bundler", "&lt;arbitrary_requirement&gt;"</code> in <code>Gemfile</code>.</li>
  <li>Automatic update of Bundler when running <code>bundle install</code> without a lockfile.</li>
  <li>Automatic update of Bundler when running <code>bundle update</code>.</li>
</ul>

<p>In other words, our end goal is to be able to treat Bundler just like any other
dependency of your application.</p>

</div>
</div>
</div>
</div>
<div class='row my-5'>
<div class='col-md-12 col-xl-10 offset-xl-1'>
<div class='contents blog'>
<h1>Previous Posts</h1>
<ul class='posts'>
<li>
<div class='date'>Feb 15, 2021</div>
<a href="/blog/2021/02/15/a-more-secure-bundler-we-fixed-our-source-priorities.html">A more secure bundler: We fixed our source priorities.</a>
</li>
<li>
<div class='date'>Dec  9, 2020</div>
<a href="/blog/2020/12/09/bundler-v2-2.html">Bundler v2.2: Multiplatform, Funding, and more.</a>
</li>
<li>
<div class='date'>Apr 27, 2020</div>
<a href="/blog/2020/04/27/march-monthly-update.html">March Bundler Update</a>
</li>
<li>
<div class='date'>May 14, 2019</div>
<a href="/blog/2019/05/14/solutions-for-cant-find-gem-bundler-with-executable-bundle.html">Solutions for 'Cant find gem bundler (>= 0.a) with executable bundle'</a>
</li>
<li>
<div class='date'>Mar 12, 2019</div>
<a href="/blog/2019/03/12/january-february-bimonthly-update.html">January and February Bundler Update</a>
</li>
<li>
<div class='date'>Feb  2, 2019</div>
<a href="/blog/2019/02/02/december-monthly-update.html">December 2018 Bundler Update</a>
</li>
<li>
<div class='date'>Jan  4, 2019</div>
<a href="/blog/2019/01/04/an-update-on-the-bundler-2-release.html">An update on the Bundler 2 release</a>
</li>
<li>
<div class='date'>Jan  3, 2019</div>
<a href="/blog/2019/01/03/announcing-bundler-2.html">Announcing Bundler 2.0</a>
</li>
<li>
<div class='date'>Dec  8, 2018</div>
<a href="/blog/2018/12/08/november-monthly-update.html">November 2018 Bundler Update</a>
</li>
<li>
<div class='date'>Nov  5, 2018</div>
<a href="/blog/2018/11/05/october-monthly-update.html">October 2018 Bundler Update</a>
</li>
<li>
<div class='date'>Nov  4, 2018</div>
<a href="/blog/2018/11/04/an-update-on-bundler-2.html">An Update on Bundler 2.0</a>
</li>
<li>
<div class='date'>Oct 25, 2018</div>
<a href="/blog/2018/10/25/announcing-bundler-1-17-0.html">Announcing Bundler 1.17.0</a>
</li>
<li>
<div class='date'>Oct 15, 2018</div>
<a href="/blog/2018/10/15/september-monthly-update.html">September 2018 Bundler Update</a>
</li>
<li>
<div class='date'>Sep 10, 2018</div>
<a href="/blog/2018/09/10/august-bundler-update.html">August 2018 Bundler Update</a>
</li>
<li>
<div class='date'>Aug 10, 2018</div>
<a href="/blog/2018/08/10/july-bundler-update.html">July 2018 Bundler Update</a>
</li>
<li>
<div class='date'>Jul 12, 2018</div>
<a href="/blog/2018/07/12/june-bundler-update.html">June 2018 Bundler Update</a>
</li>
<li>
<div class='date'>Jun  7, 2018</div>
<a href="/blog/2018/06/07/may-bundler-update.html">May 2018 Bundler Update</a>
</li>
<li>
<div class='date'>May  7, 2018</div>
<a href="/blog/2018/05/07/april-bundler-monthly-update.html">April 2018 Bundler Update</a>
</li>
<li>
<div class='date'>Apr  9, 2018</div>
<a href="/blog/2018/04/09/march-bundler-update.html">March 2018 Bundler Update</a>
</li>
<li>
<div class='date'>Mar  9, 2018</div>
<a href="/blog/2018/03/09/february-bundler-update.html">February 2018 Bundler Update</a>
</li>
<li>
<div class='date'>Jan 17, 2018</div>
<a href="/blog/2018/01/17/making-gem-development-a-little-better.html">Making gem development a little better</a>
</li>
<li>
<div class='date'>Jan  8, 2018</div>
<a href="/blog/2018/01/08/monthly-update-for-december-and-yearly-update-for-2017.html">Monthly update for December and yearly update for 2017</a>
</li>
<li>
<div class='date'>Oct 31, 2017</div>
<a href="/blog/2017/10/31/bundler-1-16.html">Bundler 1.16: 2.0 Is So Close!</a>
</li>
<li>
<div class='date'>May 19, 2017</div>
<a href="/blog/2017/05/19/bundler-1-15-bundle-oh-so-fast.html">Bundler 1.15: Bundle Oh So Fast</a>
</li>
<li>
<div class='date'>Mar 28, 2017</div>
<a href="/blog/2017/03/28/bundler-1-14-so-many-fixes.html">Bundler 1.14: So many fixes</a>
</li>
<li>
<div class='date'>Sep  8, 2016</div>
<a href="/blog/2016/09/08/bundler-1-13.html">Bundler 1.13: The one with steady improvements</a>
</li>
<li>
<div class='date'>Jul 10, 2016</div>
<a href="/blog/2016/07/10/bundler-1-13-and-redesigned-bundler-io.html">A New Bundler Website</a>
</li>
<li>
<div class='date'>Apr 28, 2016</div>
<a href="/blog/2016/04/28/the-new-index-format-fastly-and-bundler-1-12.html">The new index format, Fastly, and Bundler 1.12</a>
</li>
<li>
<div class='date'>Dec 12, 2015</div>
<a href="/blog/2015/12/12/version-1-11-released.html">Version 1.11 released</a>
</li>
<li>
<div class='date'>Jun 24, 2015</div>
<a href="/blog/2015/06/24/version-1-10-released.html">Version 1.10 released</a>
</li>
<li>
<div class='date'>Mar 21, 2015</div>
<a href="/blog/2015/03/21/hello-bundler-19.html">Hello, Bundler 1.9!</a>
</li>
<li>
<div class='date'>Mar 20, 2015</div>
<a href="/blog/2015/03/20/moving-bins-to-exe.html">Bundler template moves bins to exe</a>
</li>
<li>
<div class='date'>Mar 19, 2015</div>
<a href="/blog/2015/03/19/announcing-ruby-together.html">Announcing Ruby Together</a>
</li>
<li>
<div class='date'>Aug 15, 2014</div>
<a href="/blog/2014/08/15/gem-not-found-error-on-1-7-0.html">Gem not found error on 1.7.0</a>
</li>
<li>
<div class='date'>Aug 14, 2014</div>
<a href="/blog/2014/08/14/bundler-may-install-gems-from-a-different-source-than-expected-cve-2013-0334.html">Bundler may install gems from a different source than expected (CVE-2013-0334)</a>
</li>
<li>
<div class='date'>Jul 16, 2014</div>
<a href="/blog/2014/07/16/bundler-api-outages.html">Bundler API outages on July 15 & 16, 2014</a>
</li>
<li>
<div class='date'>Dec  7, 2013</div>
<a href="/blog/2013/12/07/the-rumors-of-bundlers-death-have-been-greatly-exaggerated.html">The rumors of Bundler's death have been greatly exaggerated</a>
</li>
<li>
<div class='date'>Oct 12, 2013</div>
<a href="/blog/2013/10/12/goodbye-bundler-14-hello-bundler-15.html">Goodbye Bundler 1.4, Hello Bundler 1.5</a>
</li>
</ul>
</div>
</div>
</div>
</div>



<div class='footer'>
<nav class='navbar justify-content-center'>
<ul class='navbar-nav'>
<li class='nav-item'><a href="/docs.html" class="nav-link px-3">Docs</a></li>
<li class='nav-item'><a href="/contributors.html" class="nav-link px-3">Team</a></li>
<li class='nav-item'><a href="/blog" class="nav-link px-3">Blog</a></li>
<li class='nav-item'><a href="https://github.com/rubygems/rubygems/tree/master/bundler" class="nav-link px-3">Repository</a></li>
</ul>
</nav>

</div>
</body>
</html>
